type UserProfile {
  email: String!
  firebaseUid: String!
  role: String!
  permissions: [String!]!
  id: ID!
  created: Date!
  currency: String!
}

type ReturnToken {
  twoFaEnabled: Boolean!
  token: String!
  twoFaSecret: String
  twoFaQrCode: String
  walletExists: Boolean!
  profile: UserProfile!
}

type ValidateExistingTokenResponse {
  twoFaEnabled: Boolean!
  twoFaAuthenticated: Boolean!
  walletExists: Boolean!
  profile: UserProfile!
  twoFaSecret: String
  twoFaQrCode: String
}

type TwoFaRegisterResponse {
  twoFaSecret: String
  twoFaQrCode: String
}

type TwoFaValidationResponse {
  authenticated: Boolean!
  newToken: String
}

type Mutation {
  login(token: String!): ReturnToken!
  twoFaRegister: TwoFaRegisterResponse!
  disableTwoFa(totpToken: String!): TwoFaValidationResponse!
  createUser(userInfo: CreateUserInput!): ReturnToken!
}

type Query {
  twoFaValidate(totpToken: String!): TwoFaValidationResponse!
  validateExistingToken: ValidateExistingTokenResponse!
  walletPasswordRequired: Boolean!
}
